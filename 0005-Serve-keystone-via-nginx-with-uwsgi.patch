From 8f8274cdda9c0166e5c79bf36c060f923534881c Mon Sep 17 00:00:00 2001
From: Obed N Munoz <obed.n.munoz@intel.com>
Date: Fri, 10 Feb 2017 18:18:46 -0600
Subject: [PATCH] Serve keystone via nginx with uwsgi

Signed-off-by: Obed N Munoz <obed.n.munoz@intel.com>
---
 httpd/admin.ini     | 11 +++++++++++
 httpd/keystone.conf | 19 +++++++++++++++++++
 httpd/public.ini    | 11 +++++++++++
 3 files changed, 41 insertions(+)
 create mode 100644 httpd/admin.ini
 create mode 100644 httpd/keystone.conf
 create mode 100644 httpd/public.ini

diff --git a/httpd/admin.ini b/httpd/admin.ini
new file mode 100644
index 0000000..8623301
--- /dev/null
+++ b/httpd/admin.ini
@@ -0,0 +1,11 @@
+[uwsgi]
+plugins-dir = /usr/lib/uwsgi
+plugin = python27
+master = true
+processes = 5
+threads = 1
+protocol = uwsgi
+chdir = /usr/bin
+wsgi-file = keystone-wsgi-admin
+uid = keystone
+gid = keystone
diff --git a/httpd/keystone.conf b/httpd/keystone.conf
new file mode 100644
index 0000000..ad7aca3
--- /dev/null
+++ b/httpd/keystone.conf
@@ -0,0 +1,19 @@
+server {
+       listen 35357;
+       server_name localhost;
+       location / {
+               include uwsgi_params;
+               uwsgi_pass unix:/run/uwsgi/keystone/admin.sock;
+               uwsgi_param SCRIPT_NAME '';
+       }
+}
+
+server {
+       listen 5000;
+       server_name localhost;
+       location / {
+               include uwsgi_params;
+               uwsgi_pass unix:/run/uwsgi/keystone/public.sock;
+               uwsgi_param SCRIPT_NAME '';
+       }
+}
diff --git a/httpd/public.ini b/httpd/public.ini
new file mode 100644
index 0000000..430109b
--- /dev/null
+++ b/httpd/public.ini
@@ -0,0 +1,11 @@
+[uwsgi]
+plugins-dir = /usr/lib/uwsgi
+plugin = python27
+master = true
+processes = 5
+threads = 1
+protocol = uwsgi
+chdir = /usr/bin
+wsgi-file = keystone-wsgi-public
+uid = keystone
+gid = keystone
-- 
2.11.1

