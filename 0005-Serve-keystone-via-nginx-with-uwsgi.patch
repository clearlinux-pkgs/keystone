From 91bccf5e62f9249e7026605681138b1118d48c9f Mon Sep 17 00:00:00 2001
From: "Munoz, Obed N" <obed.n.munoz@intel.com>
Date: Wed, 18 Nov 2015 17:45:49 -0600
Subject: [PATCH] Serve keystone via nginx with uwsgi

Signed-off-by: Munoz, Obed N <obed.n.munoz@intel.com>
---
 httpd/admin.ini     |  9 +++++++++
 httpd/keystone.conf | 19 +++++++++++++++++++
 httpd/public.ini    |  9 +++++++++
 3 files changed, 37 insertions(+)
 create mode 100644 httpd/admin.ini
 create mode 100644 httpd/keystone.conf
 create mode 100644 httpd/public.ini

diff --git a/httpd/admin.ini b/httpd/admin.ini
new file mode 100644
index 0000000..7e3e37e
--- /dev/null
+++ b/httpd/admin.ini
@@ -0,0 +1,9 @@
+[uwsgi]
+master = true
+processes = 5
+threads = 1
+protocol = uwsgi
+chdir = /usr/bin
+wsgi-file = keystone-wsgi-admin
+uid = keystone
+gid = keystone
diff --git a/httpd/keystone.conf b/httpd/keystone.conf
new file mode 100644
index 0000000..ad7aca3
--- /dev/null
+++ b/httpd/keystone.conf
@@ -0,0 +1,19 @@
+server {
+       listen 35357;
+       server_name localhost;
+       location / {
+               include uwsgi_params;
+               uwsgi_pass unix:/run/uwsgi/keystone/admin.sock;
+               uwsgi_param SCRIPT_NAME '';
+       }
+}
+
+server {
+       listen 5000;
+       server_name localhost;
+       location / {
+               include uwsgi_params;
+               uwsgi_pass unix:/run/uwsgi/keystone/public.sock;
+               uwsgi_param SCRIPT_NAME '';
+       }
+}
diff --git a/httpd/public.ini b/httpd/public.ini
new file mode 100644
index 0000000..d34ccd3
--- /dev/null
+++ b/httpd/public.ini
@@ -0,0 +1,9 @@
+[uwsgi]
+master = true
+processes = 5
+threads = 1
+protocol = uwsgi
+chdir = /usr/bin
+wsgi-file = keystone-wsgi-public
+uid = keystone
+gid = keystone
-- 
2.6.2

