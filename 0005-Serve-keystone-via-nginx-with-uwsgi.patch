From f431043d781e2008cebc6503823adfbd5140eb51 Mon Sep 17 00:00:00 2001
From: Alberto Murillo <alberto.murillo.silva@intel.com>
Date: Thu, 22 Oct 2015 14:05:47 -0500
Subject: [PATCH] Serve keystone via nginx with uwsgi.

Signed-off-by: Victor Morales <victor.morales@intel.com>
---
 httpd/admin.ini     | 10 ++++++++++
 httpd/keystone.conf | 19 +++++++++++++++++++
 httpd/public.ini    | 10 ++++++++++
 3 files changed, 39 insertions(+)
 create mode 100644 httpd/admin.ini
 create mode 100644 httpd/keystone.conf
 create mode 100644 httpd/public.ini

diff --git a/httpd/admin.ini b/httpd/admin.ini
new file mode 100644
index 0000000..211f589
--- /dev/null
+++ b/httpd/admin.ini
@@ -0,0 +1,10 @@
+[uwsgi]
+master = true
+processes = 5
+threads = 1
+protocol = uwsgi
+chdir = /usr/bin
+logto = /var/log/uwsgi/keystone-admin.log
+wsgi-file = keystone-wsgi-admin
+uid = keystone
+gid = keystone
diff --git a/httpd/keystone.conf b/httpd/keystone.conf
new file mode 100644
index 0000000..ad7aca3
--- /dev/null
+++ b/httpd/keystone.conf
@@ -0,0 +1,19 @@
+server {
+       listen 35357;
+       server_name localhost;
+       location / {
+               include uwsgi_params;
+               uwsgi_pass unix:/run/uwsgi/keystone/admin.sock;
+               uwsgi_param SCRIPT_NAME '';
+       }
+}
+
+server {
+       listen 5000;
+       server_name localhost;
+       location / {
+               include uwsgi_params;
+               uwsgi_pass unix:/run/uwsgi/keystone/public.sock;
+               uwsgi_param SCRIPT_NAME '';
+       }
+}
diff --git a/httpd/public.ini b/httpd/public.ini
new file mode 100644
index 0000000..3f7fc95
--- /dev/null
+++ b/httpd/public.ini
@@ -0,0 +1,10 @@
+[uwsgi]
+master = true
+processes = 5
+threads = 1
+protocol = uwsgi
+chdir = /usr/bin
+logto = /var/log/nginx/keystone.log
+wsgi-file = keystone-wsgi-public
+uid = keystone
+gid = keystone
-- 
2.1.0

